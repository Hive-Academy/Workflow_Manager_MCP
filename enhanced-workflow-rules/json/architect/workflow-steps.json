{
  "workflowSteps": [
    {
      "name": "comprehensive_context_and_redelegation_analysis",
      "displayName": "Comprehensive Context and Redelegation Analysis",
      "description": "Retrieve task context, analyze redelegation issues, and integrate existing analysis",
      "sequenceNumber": 1,
      "isRequired": true,
      "estimatedTime": "8-12 minutes",
      "stepType": "ANALYSIS",
      "behavioralContext": {
        "approach": "Comprehensive context acquisition with redelegation issue analysis",
        "principles": [
          "Use TaskOperations with comprehensive inclusion for complete context",
          "Extract and validate ALL redelegation context provided",
          "Build upon existing codebase analysis rather than re-analyzing",
          "Focus on evidence-based issue validation"
        ],
        "methodology": "MCP-driven context acquisition with redelegation-aware analysis",
        "analysisMethod": {
          "contextExtraction": "Extract redelegation context from handoff message including issue root cause, existing work, and testing results",
          "validationApproach": "Validate redelegation issues through focused verification rather than full re-analysis",
          "integrationStrategy": "Leverage existing boomerang codebase analysis as strategic foundation",
          "gapIdentification": "Identify strategic gaps requiring architectural enhancement"
        },
        "validationCriteria": {
          "issueConfirmation": "Verify reported issue through testing and evidence",
          "patternValidation": "Test that existing patterns support the planned enhancement",
          "solutionAlignment": "Confirm enhancement aligns with current architecture",
          "contextCompleteness": "Ensure all redelegation context is captured and understood"
        }
      },
      "approachGuidance": {
        "stepByStep": [
          "Execute TaskOperations.get with comprehensive parameters including plans and subtasks",
          "Extract redelegation context: issue root cause, existing work, testing results",
          "Validate redelegation issues through focused verification (not full re-analysis)",
          "Leverage existing boomerang codebase analysis as strategic foundation",
          "Identify strategic gaps requiring architectural enhancement"
        ],
        "analysisSteps": [
          "Parse handoff message for detailed context and analysis results",
          "Extract specific refactoring targets and patterns identified",
          "Validate reported issues through focused testing and verification",
          "Map existing analysis to current architectural decisions needed"
        ],
        "validationSteps": [
          "Verify reported issue through direct testing or code inspection",
          "Test that existing patterns support the enhancement approach",
          "Confirm enhancement aligns with established architecture principles",
          "Validate that redelegation context provides sufficient detail for decisions"
        ]
      },
      "qualityChecklist": [
        "Complete task context retrieved including research findings and plans",
        "Redelegation issues extracted and root cause validated through evidence",
        "Existing codebase analysis integrated as foundation for decisions",
        "Strategic gaps identified for architectural solution with clear rationale",
        "Evidence-based issue verification completed with documentation"
      ],
      "conditions": [],
      "actions": [
        {
          "name": "acquire_comprehensive_context",
          "actionType": "MCP_CALL",
          "actionData": {
            "serviceName": "TaskOperations",
            "operation": "get",
            "parameters": {
              "includeLevel": "comprehensive",
              "includePlans": true,
              "includeSubtasks": true,
              "includeAnalysis": true,
              "includeComments": true,
              "includeCodebaseAnalysis": true,
              "includeRedelegationContext": true
            }
          },
          "sequenceOrder": 1
        }
      ],
      "triggerReport": true,
      "reportType": "context_and_redelegation_analysis",
      "reportTemplate": "comprehensive_context_analysis"
    },
    {
      "name": "strategic_pattern_enhancement_and_solution_design",
      "displayName": "Strategic Pattern Enhancement and Solution Design",
      "description": "Design evidence-based solutions using SOLID principles and existing architectural patterns",
      "sequenceNumber": 2,
      "isRequired": true,
      "estimatedTime": "20-30 minutes",
      "stepType": "ACTION",
      "behavioralContext": {
        "approach": "Evidence-based solution design with SOLID principles and pattern enhancement",
        "principles": [
          "Build upon existing codebase analysis patterns rather than re-discovery",
          "Design solutions based on VERIFIED problems, not assumptions",
          "Apply SOLID principles to all architectural decisions",
          "Enhance existing patterns rather than creating new ones"
        ],
        "methodology": "Strategic enhancement design with evidence-based validation",
        "designMethod": {
          "solutionApproach": "Design evidence-based architectural solutions addressing verified issues",
          "patternEnhancement": "Enhance existing patterns rather than replacing them",
          "architecturalConsistency": "Maintain service boundaries and established patterns",
          "implementationGuidance": "Provide specific code examples and detailed instructions"
        },
        "solidPrinciples": {
          "singleResponsibility": "Each class/service has one reason to change",
          "openClosed": "Extensible through inheritance/composition, not modification",
          "liskovSubstitution": "Derived classes substitutable for base classes",
          "interfaceSegregation": "Clients depend only on interfaces they use",
          "dependencyInversion": "Depend on abstractions, not concretions"
        },
        "documentationRequirements": {
          "fileSpecificInstructions": "Document exact files to modify with clear reasons",
          "methodImplementation": "Provide complete code examples following existing patterns",
          "architecturalRationale": "Explain why approach maintains consistency",
          "qualityConstraints": "Define specific validation requirements",
          "successCriteria": "Specify how to validate correct implementation",
          "antiPatternPrevention": "Document what to avoid and why"
        }
      },
      "approachGuidance": {
        "stepByStep": [
          "Leverage existing architectural patterns from codebase analysis",
          "Identify strategic enhancement opportunities based on verified issues",
          "Apply SOLID principles to solution design decisions",
          "Design pattern enhancements that maintain architectural consistency",
          "Create detailed implementation guidance with code examples",
          "Establish quality constraints and success criteria"
        ],
        "designSteps": [
          "Analyze verified issues to understand root causes and impact",
          "Map issues to appropriate SOLID principle violations",
          "Design solutions that enhance rather than replace existing patterns",
          "Create architectural blueprints with specific implementation details"
        ],
        "documentationSteps": [
          "Document architectural decisions with evidence-based rationale",
          "Create detailed implementation guidance with complete code examples",
          "Define quality constraints and measurable success criteria",
          "Establish anti-pattern prevention strategies and warnings"
        ]
      },
      "qualityChecklist": [
        "Solution based on verified problems with clear evidence",
        "SOLID principles compliance verified for all design decisions",
        "Existing architectural patterns enhanced rather than replaced",
        "Detailed implementation guidance with specific code examples provided",
        "Quality constraints and success criteria established with measurements",
        "Anti-pattern prevention strategies documented with rationale"
      ],
      "conditions": [
        {
          "name": "context_analysis_completed",
          "conditionType": "PREVIOUS_STEP_COMPLETED",
          "logic": {
            "check": "step_completed",
            "parameters": {
              "stepName": "comprehensive_context_and_redelegation_analysis"
            }
          },
          "isRequired": true
        }
      ],
      "actions": [],
      "triggerReport": true,
      "reportType": "strategic_solution_design",
      "reportTemplate": "pattern_enhancement_and_solution_design"
    },
    {
      "name": "implementation_plan_management",
      "displayName": "Strategic Implementation Plan Management",
      "description": "Create or update implementation plan with strategic enhancements and comprehensive guidance",
      "sequenceNumber": 3,
      "isRequired": true,
      "estimatedTime": "15-20 minutes",
      "stepType": "ACTION",
      "behavioralContext": {
        "approach": "Strategic plan management with existing plan preservation and enhancement",
        "principles": [
          "Check for existing plans and update rather than recreate",
          "Include task-slug for human-readable reference",
          "Preserve existing work while adding strategic enhancements",
          "Document architectural rationale and verification evidence"
        ],
        "methodology": "Adaptive plan management with strategic context integration",
        "planManagementStrategy": {
          "existingPlanCheck": "Always check for existing implementation plans before creating new ones",
          "updateApproach": "If existing plan found, update with strategic enhancements rather than recreate",
          "creationApproach": "If no existing plan, create comprehensive new plan with full context",
          "contextIntegration": "Include redelegation context and issue resolution strategy"
        }
      },
      "approachGuidance": {
        "stepByStep": [
          "Check for existing implementation plan before creating new one",
          "If existing plan found, update with strategic enhancements",
          "If no existing plan, create comprehensive new plan",
          "Include redelegation context and issue resolution strategy",
          "Document architectural decisions with evidence-based rationale",
          "Establish verification evidence and strategic context"
        ],
        "planManagementSteps": [
          "Execute PlanningOperations.get_plan to check for existing plans",
          "Evaluate existing plan quality and completeness if found",
          "Determine whether to update existing or create new plan",
          "Integrate strategic enhancements while preserving valuable existing work"
        ]
      },
      "qualityChecklist": [
        "Existing plan checked and appropriately updated or new plan created",
        "Strategic enhancements integrated with existing work preserved",
        "Architectural decisions documented with evidence-based rationale",
        "Task-slug included for human-readable reference",
        "Redelegation context and issue resolution strategy documented",
        "Verification evidence and strategic context established"
      ],
      "conditions": [
        {
          "name": "solution_design_completed",
          "conditionType": "PREVIOUS_STEP_COMPLETED",
          "logic": {
            "check": "step_completed",
            "parameters": {
              "stepName": "strategic_pattern_enhancement_and_solution_design"
            }
          },
          "isRequired": true
        }
      ],
      "actions": [
        {
          "name": "check_existing_plan",
          "actionType": "MCP_CALL",
          "actionData": {
            "serviceName": "PlanningOperations",
            "operation": "get_plan",
            "parameters": {
              "includeBatches": true,
              "includeSubtasks": true
            }
          },
          "sequenceOrder": 1
        },
        {
          "name": "create_or_update_plan",
          "actionType": "MCP_CALL",
          "actionData": {
            "serviceName": "PlanningOperations",
            "operation": "{{create_or_update_based_on_existing}}",
            "parameters": {
              "taskSlug": "{{task_slug}}",
              "planData": {
                "strategicEnhancement": "{{redelegation_issue_resolution_strategy}}",
                "technicalDecisions": "{{architectural_strategy_and_pattern_compliance}}",
                "strategicGuidance": "{{root_cause_solution_and_pattern_consistency}}",
                "verificationEvidence": "{{current_state_verified_and_evidence_based_design}}",
                "architecturalRationale": "{{strategic_solution_addresses_root_cause}}",
                "implementationStrategy": "{{strategic_enhancement_not_quick_fixes}}"
              }
            }
          },
          "sequenceOrder": 2
        }
      ],
      "triggerReport": true,
      "reportType": "implementation_plan",
      "reportTemplate": "strategic_implementation_plan"
    },
    {
      "name": "strategic_subtask_creation_with_quality_gates",
      "displayName": "Strategic Subtask Creation with Quality Gates",
      "description": "Create strategic implementation subtasks with comprehensive guidance and quality gates",
      "sequenceNumber": 4,
      "isRequired": true,
      "estimatedTime": "20-25 minutes",
      "stepType": "ACTION",
      "behavioralContext": {
        "approach": "Strategic subtask creation with comprehensive guidance and measurable quality gates",
        "principles": [
          "Create subtasks with detailed strategic guidance and architectural context",
          "Include specific implementation guidance with code examples",
          "Define measurable quality gates and validation criteria",
          "Ensure SOLID principles compliance and pattern consistency"
        ],
        "methodology": "Detailed subtask planning with quality assurance integration",
        "subtaskCreationStrategy": {
          "batchOrganization": "Create strategic batches with 3-8 subtasks following dependency order",
          "guidanceDetail": "Provide comprehensive strategic guidance for each subtask",
          "implementationSpecifics": "Include architectural context, implementation specifics, and code examples",
          "qualityIntegration": "Define quality constraints, success criteria, and anti-pattern prevention"
        },
        "qualityGateDefinition": {
          "codeQuality": "SOLID compliance, test coverage, documentation standards",
          "performance": "Response times, query efficiency, resource usage metrics",
          "security": "Input validation, authentication, authorization requirements",
          "integration": "API contracts, error handling, monitoring requirements"
        }
      },
      "approachGuidance": {
        "stepByStep": [
          "Create strategic batches with 3-8 subtasks following dependency order",
          "Provide comprehensive strategic guidance for each subtask",
          "Include architectural context, implementation specifics, and code examples",
          "Define quality constraints, success criteria, and anti-pattern prevention",
          "Establish measurable quality gates and validation criteria",
          "Document performance targets and security requirements"
        ],
        "subtaskCreationSteps": [
          "Organize implementation work into logical dependency-ordered batches",
          "For each subtask, provide architectural context and problem being solved",
          "Include specific implementation guidance with complete code examples",
          "Define measurable success criteria and validation requirements"
        ],
        "qualityGateSteps": [
          "Define comprehensive quality gates covering code, performance, security",
          "Establish measurable validation criteria that are enforceable",
          "Align quality standards with baseline metrics and security requirements",
          "Document performance targets and monitoring requirements"
        ]
      },
      "qualityChecklist": [
        "Strategic batches created with appropriate subtask organization",
        "Each subtask includes comprehensive strategic guidance and context",
        "Implementation specifics with code examples provided",
        "Quality constraints and success criteria clearly defined",
        "Measurable quality gates established for all phases",
        "Performance targets and security requirements specified"
      ],
      "conditions": [
        {
          "name": "implementation_plan_ready",
          "conditionType": "PREVIOUS_STEP_COMPLETED",
          "logic": {
            "check": "step_completed",
            "parameters": {
              "stepName": "implementation_plan_management"
            }
          },
          "isRequired": true
        }
      ],
      "actions": [
        {
          "name": "create_strategic_subtasks",
          "actionType": "MCP_CALL",
          "actionData": {
            "serviceName": "PlanningOperations",
            "operation": "create_subtasks",
            "parameters": {
              "taskSlug": "{{task_slug}}",
              "batchData": {
                "strategicContext": "{{redelegation_origin_and_solution_approach}}",
                "subtasks": [
                  {
                    "strategicGuidance": {
                      "architecturalContext": "{{problem_solved_and_pattern_followed}}",
                      "implementationSpecifics": "{{file_to_modify_and_method_to_add}}",
                      "codeExample": "{{complete_code_example_with_context}}",
                      "qualityConstraints": "{{pattern_compliance_and_error_handling}}",
                      "successCriteria": "{{validation_requirements_and_testing}}",
                      "architecturalRationale": "{{enhancement_maintains_boundaries}}"
                    }
                  }
                ]
              }
            }
          },
          "sequenceOrder": 1
        }
      ],
      "triggerReport": true,
      "reportType": "strategic_subtasks_and_quality_gates",
      "reportTemplate": "strategic_subtask_creation"
    },
    {
      "name": "delegation_preparation_and_context_documentation",
      "displayName": "Delegation Preparation and Strategic Context Documentation",
      "description": "Prepare comprehensive delegation context with architectural decisions and implementation guidance",
      "sequenceNumber": 5,
      "isRequired": true,
      "estimatedTime": "10-15 minutes",
      "stepType": "ACTION",
      "behavioralContext": {
        "approach": "Comprehensive delegation preparation with strategic context and architectural guidance",
        "principles": [
          "Document all architectural decisions with evidence-based rationale",
          "Prepare strategic context for seamless role transition",
          "Summarize quality requirements and validation criteria",
          "Ensure implementation guidance is comprehensive and actionable"
        ],
        "methodology": "Strategic context preparation with comprehensive handoff documentation",
        "delegationPreparation": {
          "decisionDocumentation": "Document all architectural decisions with rationale and evidence",
          "contextSummary": "Prepare strategic context summary for implementation teams",
          "qualityConsolidation": "Consolidate quality requirements and validation criteria",
          "handoffDocumentation": "Create comprehensive handoff documentation with implementation guidance"
        }
      },
      "approachGuidance": {
        "stepByStep": [
          "Document all architectural decisions with rationale and evidence",
          "Prepare strategic context summary for implementation teams",
          "Consolidate quality requirements and validation criteria",
          "Create comprehensive handoff documentation with implementation guidance",
          "Ensure all anti-pattern prevention strategies are clearly communicated",
          "Validate that delegation context enables immediate implementation start"
        ],
        "preparationSteps": [
          "Consolidate all architectural decisions made during design phase",
          "Create summary of strategic context for next role",
          "Document quality requirements and success criteria clearly",
          "Ensure handoff documentation enables immediate productive work"
        ]
      },
      "qualityChecklist": [
        "All architectural decisions documented with evidence-based rationale",
        "Strategic context prepared for implementation teams",
        "Quality requirements and validation criteria consolidated",
        "Comprehensive handoff documentation created",
        "Anti-pattern prevention strategies clearly communicated",
        "Delegation context enables immediate implementation start"
      ],
      "conditions": [
        {
          "name": "subtasks_and_quality_gates_ready",
          "conditionType": "PREVIOUS_STEP_COMPLETED",
          "logic": {
            "check": "step_completed",
            "parameters": {
              "stepName": "strategic_subtask_creation_with_quality_gates"
            }
          },
          "isRequired": true
        }
      ],
      "actions": [],
      "triggerReport": true,
      "reportType": "delegation_preparation",
      "reportTemplate": "strategic_delegation_context"
    },
    {
      "name": "strategic_senior_developer_delegation",
      "displayName": "Strategic Senior Developer Delegation with Context",
      "description": "Delegate to senior developer with comprehensive strategic context and implementation readiness",
      "sequenceNumber": 6,
      "isRequired": true,
      "estimatedTime": "5-8 minutes",
      "stepType": "ACTION",
      "behavioralContext": {
        "approach": "Strategic delegation with comprehensive context preservation and implementation readiness",
        "principles": [
          "Include task-slug for human-readable reference",
          "Provide complete strategic context and architectural guidance",
          "Ensure implementation readiness with clear quality requirements",
          "Establish ongoing architectural support availability"
        ],
        "methodology": "Context-preserving delegation with strategic implementation guidance"
      },
      "approachGuidance": {
        "stepByStep": [
          "Execute delegation with comprehensive strategic context",
          "Include task-slug for clear human-readable reference",
          "Communicate implementation priorities and architectural guidance",
          "Ensure quality requirements and success criteria are understood",
          "Provide clear message about architectural support availability",
          "Confirm delegation context enables immediate productive work"
        ]
      },
      "qualityChecklist": [
        "Delegation executed with comprehensive strategic context",
        "Task-slug included for human-readable reference",
        "Implementation priorities and architectural guidance communicated",
        "Quality requirements and success criteria clearly understood",
        "Architectural support availability established",
        "Delegation enables immediate productive implementation work"
      ],
      "conditions": [
        {
          "name": "delegation_preparation_completed",
          "conditionType": "PREVIOUS_STEP_COMPLETED",
          "logic": {
            "check": "step_completed",
            "parameters": {
              "stepName": "delegation_preparation_and_context_documentation"
            }
          },
          "isRequired": true
        }
      ],
      "actions": [
        {
          "name": "execute_strategic_delegation",
          "actionType": "MCP_CALL",
          "actionData": {
            "serviceName": "WorkflowOperations",
            "operation": "delegate",
            "parameters": {
              "taskSlug": "{{task_slug}}",
              "fromRole": "architect",
              "toRole": "senior-developer",
              "message": "Strategic architectural solution designed for task [{{task_slug}}] - elegant enhancement with comprehensive implementation guidance, patterns, code examples, and quality constraints.",
              "strategicContext": {
                "issueResolved": "{{complex_pattern_violations_requiring_architectural_solution}}",
                "solutionApproach": "{{service_enhancement_following_established_patterns}}",
                "implementationReadiness": true,
                "patternComplianceEnsured": true,
                "qualityGatesDefinied": true,
                "technicalDebtPrevention": true,
                "elegantSolutionDesigned": true
              },
              "architecturalGuidance": {
                "corePattern": "{{enhance_service_with_method}}",
                "implementationStrategy": "{{follow_existing_patterns_exactly}}",
                "qualityAssurance": "{{comprehensive_testing_with_integration}}",
                "antiPatternAvoidance": "{{eliminate_all_anti_patterns}}"
              },
              "verificationContext": {
                "currentStateVerified": true,
                "issuesConfirmedThroughTesting": true,
                "evidenceBasedSolution": true,
                "patternValidityTested": true
              }
            }
          },
          "sequenceOrder": 1
        }
      ],
      "triggerReport": true,
      "reportType": "strategic_delegation_complete",
      "reportTemplate": "architect_delegation_summary"
    }
  ]
}
